(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2287:function(e,t,s){Promise.resolve().then(s.bind(s,7546))},7546:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var l=s(7437),r=s(605),n=s(2265),a=s(7380),i=e=>{let{message:t,type:s,onClose:r}=e;return(0,l.jsxs)("div",{className:"flex items-center p-4 mb-4 border-l-4 ".concat({success:"bg-green-100 border-green-400 text-green-700",error:"bg-red-100 border-red-400 text-red-700",warning:"bg-yellow-100 border-yellow-400 text-yellow-700",info:"bg-blue-100 border-yellow-400 text-yellow-700"}[s]," rounded"),role:"alert",children:[(0,l.jsx)("div",{className:"flex-1",children:t}),r&&(0,l.jsx)("button",{onClick:r,className:"ml-4 text-gray-500 hover:text-gray-700",children:"\xd7"})]})},o=s(2249);let d=e=>{let{link:t}=e,[s,r]=(0,n.useState)(!1),[a,o]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=setTimeout(()=>{o(!1)},2e3);return()=>clearTimeout(e)},[a]),(0,l.jsxs)(l.Fragment,{children:[a&&(0,l.jsx)("div",{className:"absolute left-4 top-7",children:(0,l.jsx)(i,{message:"Link coppied!",type:"info",onClose:()=>o(!1)})}),(0,l.jsxs)("div",{className:"relative inline-block",children:[(0,l.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(t),o(!0)},className:"flex items-center justify-center p-2 bg-blue-500 text-white rounded shadow hover:bg-blue-600 transition duration-200","aria-label":"Copy link",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onBlur:()=>r(!1),children:(0,l.jsx)("svg",{className:"w-5 h-5",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"LinkIcon","aria-label":"fontSize large",children:(0,l.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"})})}),s&&(0,l.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 mt-2 p-2 bg-gray-700 text-white text-sm rounded shadow",children:"Copy shareable link!"})]})]})};var c=e=>{let{initialFiles:t}=e,[s,r]=(0,n.useState)(t||[]),a=0===s.length;return(0,n.useEffect)(()=>{(null==t?void 0:t.length)>0&&r(t)},[t]),(0,l.jsxs)("div",{className:a?"h-[140px] text-center flex justify-center items-center border rounded":"",children:[a?"No files uploaded":null,!a&&(0,l.jsx)(o.Z5,{onDragEnd:e=>{if(!e.destination)return;let t=Array.from(s),[l]=t.splice(e.source.index,1);t.splice(e.destination.index,0,l),r(t)},children:(0,l.jsx)(o.bK,{droppableId:"droppableIdUnique",children:e=>(0,l.jsxs)("div",{...e.droppableProps,ref:e.innerRef,className:"px-2 grid grid-cols-3 gap-3 h-[200px] overflow-y-auto border rounded",children:[s.map((e,t)=>(0,l.jsx)(o._l,{draggableId:e.id,index:t,children:t=>(0,l.jsxs)("div",{ref:t.innerRef,...t.draggableProps,...t.dragHandleProps,className:"border p-2 my-2 h-[160px] bg-white rounded shadow",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Name:"})," ",e.name]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Type:"})," ",e.type]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Tags:"})," ",(null==e?void 0:e.tags)&&(null==e?void 0:e.tags)]}),(null==e?void 0:e.shareableLink)&&(0,l.jsx)(d,{link:null==e?void 0:e.shareableLink})]})},e.id)),e.placeholder]})})})]})},u=e=>{let{username:t}=e,[s,r]=(0,n.useState)([]),[o,d]=(0,n.useState)(""),[u,h]=(0,n.useState)([]),[p,x]=(0,n.useState)(!1),g=async()=>{if(0===s.length)return;let e=new FormData;e.append("file",s[0]),e.append("tags",o);let t=await fetch("/api/files/upload",{method:"POST",body:JSON.stringify({username:"user1",file:{name:s[0].name,type:s[0].type},tags:o}),headers:{"Content-Type":"application/json"}});if(t.ok){let e=await t.json();h(t=>[...t,e.file]),await m(),d(""),r([]),x(!0)}else alert((await t.json()).error)},m=async()=>{let e=await fetch("/api/files/".concat(t));e.ok?h((await e.json()).uploadedFiles):alert("Failed to fetch uploaded files")};(0,n.useEffect)(()=>{m()},[t]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{x(!1)},2e3);return()=>clearTimeout(e)},[p]);let{getRootProps:b,getInputProps:f}=(0,a.uI)({accept:{"image/*":[".jpeg",".jpg",".png"],"video/*":[".mp4",".webm"]},onDrop:e=>{r(e)}}),j=(null==u?void 0:u.length)===0,v=0===s.length;return(0,l.jsxs)("div",{className:"p-4",children:[p&&(0,l.jsx)("div",{className:"absolute left-4 top-7",children:(0,l.jsx)(i,{message:"Uploaded successfully!",type:"success",onClose:()=>x(!1)})}),(0,l.jsxs)("div",{...b({className:"dropzone border-2 border-dashed border-gray-400 p-4 mb-4 text-center"}),children:[(0,l.jsx)("input",{...f()}),(0,l.jsx)("p",{children:"Drag and drop some files here, or click to select files"})]}),(0,l.jsx)("input",{type:"text",placeholder:"Tags (comma-separated)",value:o,onChange:e=>d(e.target.value),className:"border p-2 mb-4 w-full"}),(0,l.jsx)("button",{onClick:g,className:v?"bg-gray-300 text-white py-2 px-4 rounded ":"bg-blue-500 text-white py-2 px-4 rounded",disabled:v,children:"Upload"}),(0,l.jsx)("h2",{className:"mt-4 text-lg font-bold text-left mb-2",children:"Uploaded Files"}),(0,l.jsx)(c,{initialFiles:u,noFilesUploaded:j})]})},h=()=>{var e;let[t,s]=(0,n.useState)(""),[r,a]=(0,n.useState)(""),[i,o]=(0,n.useState)(""),[d,c]=(0,n.useState)(null),h=async e=>{e.preventDefault();let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:r})}),l=await s.json();s.ok?(c({user:{username:t}}),o("Welcome, ".concat(t,"!"))):o(l.error||"Login failed: Invalid credentials")},p=async()=>{c(null),o("Logged out successfully")},x=null==d?void 0:null===(e=d.user)||void 0===e?void 0:e.username;return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,l.jsxs)("div",{className:d?"bg-white p-8 rounded-lg shadow-md w-full max-w-3xl":"bg-white p-8 rounded-lg shadow-md w-96",children:[!d&&(0,l.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Login"}),d?(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("p",{className:"mb-4",children:["Welcome, ",x,"!"]}),(0,l.jsx)(u,{username:x}),(0,l.jsx)("button",{onClick:p,className:"w-full bg-red-500 text-white py-2 rounded hover:bg-red-600 transition duration-200",children:"Logout"})]}):(0,l.jsxs)("form",{onSubmit:h,children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsx)("input",{type:"text",placeholder:"Username",value:t,onChange:e=>s(e.target.value),required:!0,className:"w-full border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("input",{type:"password",placeholder:"Password",value:r,onChange:e=>a(e.target.value),required:!0,className:"w-full border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,l.jsx)("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600 transition duration-200",children:"Login"}),i&&(0,l.jsx)("p",{className:"text-red-500 text-center mt-2",children:i})]})]})})};function p(){return(0,l.jsx)(r.SessionProvider,{children:(0,l.jsx)(h,{})})}}},function(e){e.O(0,[216,457,971,117,744],function(){return e(e.s=2287)}),_N_E=e.O()}]);